# Проект 6. 
# <center> Проект: Сегментирование клиентов онлайн-магазина подарков  

## Оглавление  
[1. Описание проекта](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#описание-проекта-)  
[2. Какой кейс решаем?](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#Какой-кейс-решаем)  
[3. Краткая информация о данных](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#Этапы-работы-над-проектом)  
[5. Результат](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#результаты)    
[6. Выводы](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#Выводы) 

### **Описание проекта **   
Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением электронной коммерции, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

img
Источник изображения
Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из Google Analytics или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать модели поведения профессиональных покупателей, определять категорию клиентов (например, лояльные/перспективные/новички/«спящие»/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

Стоит также отметить, что компании, использующие машинное обучение на своих платформах электронной коммерции, могут постоянно повышать эффективность бизнес-процессов: настраивать товарную выборку персонально для каждого покупателя и предлагать выгодную цену в соответствии с бюджетом клиента и т. д. Эта задача относится к категории построения рекомендательных систем, речь о которых пойдёт в следующем разделе нашего курса.

Как правило, наборы данных для электронной коммерции являются частной собственностью и, следовательно, их трудно найти среди общедоступных данных.

Однако в The UCI Machine Learning Repository создали набор данных, содержащий фактические транзакции за 2010 и 2011 годы. С ним нам как раз и предстоит поработать в этом проекте.
Датасет содержит все транзакции, произошедшие за период с 01/12/2010 по 09/12/2011, для базирующейся в Великобритании компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками.

:arrow_up:[к оглавлению](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#оглавление)


### **Какой кейс решаем?**
**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача** для вас как для специалиста в Data Science: построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

ОСНОВНЫЕ ЦЕЛИ:

1. Произвести предобработку набора данных.
2. Провести разведывательный анализ данных и выявить основные закономерности.
3. Сформировать категории товаров и клиентов.
4. Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.
5. Спроектировать процесс предсказания категории интересов клиента и 
протестировать вашу модель на новых клиентах.


**Метрика качества**   
* Accuracy


**Что практикуем**     
1. **Базовый анализ и знакомство с данными**

Первая часть проекта будет посвящена знакомству с исходными данными и их структурой.


2. **Предобработка и очистка данных**

Далее вам необходимо будет подготовить датасет для кластеризации, очистив его от пропусков, дублей, выбросов и другого «мусора».

3. **Разведывательный анализ данных (EDA)**

Вам предстоит произвести небольшое исследование данных, нащупать первые закономерности и выдвинуть гипотезы.


4. **RFM-сегментация клиентов. Часть I**

Вы познакомитесь с очень популярным в маркетинге методом сегментации клиентов под названием RFM (Recency, Frequency, Monetary). На основе этого метода вы сформируете из исходного датасета о транзакциях таблицу с RFM-характеристиками клиентов и произведёте их первичную сегментацию.

5. **RFM-сегментация клиентов. Часть II**

Мы попробуем расширить наши клиентские сегменты и создать промежуточные категории с помощью нелинейных преобразований размерности. Это позволит произвести более качественную кластеризацию и улучшить стратегии взаимодействия с клиентами.

6. **RFM-сегментация клиентов. Часть III**

Наконец, вам будет необходимо построить модель классификации, которая позволит автоматически определять сегмент клиента на основе нескольких транзакций.


### **Краткая информация о данных**
Yабор данных, содержащий фактические транзакции за 2010 и 2011 годы. С ним нам как раз и предстоит поработать в этом проекте.
Датасет содержит все транзакции, произошедшие за период с 01/12/2010 по 09/12/2011, для базирующейся в Великобритании компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками.


:arrow_up:[к оглавлению](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#оглавление)


### **Этапы работы над проектом**  
1. предобработка и очистка данных, создание новых признаков и манипуляции над таблицами;
2. разведывательный анализ данных, включая статистику;
3. решение задач обучения без учителя: кластеризация и снижение размерности;
4. решение задач обучения с учителем: классификация;
валидация моделей и оценка качества.


:arrow_up:[к оглавлению](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#оглавление)


### **Результаты:**  
* Проведена предобработка и очистка данных: удалены пропуски и дубликаты; идентифицированы и удалены транзакции-возвраты, количество возвращенного товара по заказам выделено в отдельный признак; идентифицированы и удалены транзакции специального характера, не представляющие интереса для кластерного анализа клиентов.
* Рассмотрены распределения клиентов, количества заказов и выручки по странам.
* Проанализировано количество продаж по месяцам, дням недели, времени суток. 
* Сформирован датасет для анализа клиентов по модели RFM: Recency-Frequency-Monetary Value.
* Проведено PCA-снижение размерности до двух компонент, проведена кластеризация несколькими методами, выбран оптимальный алгоритм.
* Проведен анализ отличий в разных кластерах.
* Аналогичные шаги кластеризации повторены для нелинейного снижения размерности методом t-SNE.
* Построены модели классификации клиентов.

Для решения задачи кластеризации в данном кейсе отлично себя показали модели:

✓ случайный леc RandomForestClassifier

✓ Градиентный бустинг над деревьями решений GradientBoostingClassifier

| Обученная модель | Accuracy<br> на тестовой выборке |
| :---: | :---: |
| **RandomForestClassifier** | <font color=LightSeaGreen>**0.985**</font> |
| **GradientBoostingClassifier** | <font color=LightSeaGreen>**0.990**</font> |



:arrow_up:[к оглавлению](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#оглавление)


### **Выводы:**  
В процессе выполнения кейса первоначальные данные были:

1. Внимательно изучены исходные данные и проанализированы;
2. Проведена подготовка данных к использованию: очистка, преобразование, исключение, создание признаков;
3. Данные были исследованы на длительности поездок, выявлены зависимости, построены графики отражающие зависимости, сформированы выводы по данным;
4. Построены обучающие модели, основанные на алгоритмах машинного обучения, выбраны несколько из них по максимальной целевой метрике Accuracy;


:arrow_up:[к оглавлению](https://github.com/Balantre/New_octopus/blob/main/project_5/README.md#оглавление)

[Ноутбук с выполненными заданиями и выводами](https://github.com/Balantre/New_octopus/blob/main/project_5/Project-5_MATH_ML_1.ipynb)

[Датасеты](https://drive.google.com/drive/folders/1eTf0ZMqsTgjEvIkvFYdMEjstpK7VdhAj?usp=sharing)

### <center> Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами